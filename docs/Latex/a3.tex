% !TEX encoding = UTF-8
%Koma article
\documentclass[fontsize=12pt,paper=letter,twoside]{scrartcl}
\usepackage{float}
\usepackage{listings}
\usepackage{makecell}

%Standard Pre-amble
\input{sty/defns.tex}
%Useful definitions
%\newcommand{\mv}[1]{\textit{m\_#1}}
%\newcommand{\cv}[1]{\textit{c\_#1}}
%\newcommand{\degree}[1]{^{\circ}\mathrm{#1}}
%\newcommand{\comment}[1]{{\footnotesize \quad\texttt{--}\textrm{#1}}}


%For Code Stylings
\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=Java,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

% Set the header
\ihead[]{\small EECS4313 Assignment-3}


%%%%%%%%%%%%Enter your names here%%%%%%%%
\author{Student Name | Student Number | EECS Account
\and \textbf{Edward Vaisman | 212849857 | eddyv}
\and \textbf{Robin Bandzar | 212200531 | cse23028}
\and \textbf{Kirusanth Thiruchelvam | 212918298 | kirusant}
\and \textbf{Sadman Sakib Hasan | 212497509 | cse23152}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\date{\today} % Display a given date or no date

\begin{document}
\title{EECS 4313 Assignment 3 \\Data Flow Testing, Slice-Based Testing and Mutation Testing}
\maketitle

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\tableofcontents


\newpage


\section{BORG Calendar}

\subsection{Mutation Testing}
Mutation tests were run using the previous unit test suite that we created for assignment 2. The program used to run the Mutation tests was \emph{Eclispe} with the \emph{Pitclipse} plugin. The three methods that we tested are listed with their results in the following subsections. 

\subsubsection{minuteString}


\begin{figure}[H]
\begin{center}
\includegraphics[width=.99\textwidth]{images/MutationTesting/minuteStringCode.png}
\end{center}
\caption{Code for the minuteString method}
\label{fig:minuteStringCode}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=.99\textwidth]{images/MutationTesting/minuteStringMutant.png}
\end{center}
\caption{Mutations for the minuteString method}
\label{fig:minuteStringMutant}
\end{figure}

As one can see in Figures \ref{fig:minuteStringCode} and \ref{fig:minuteStringMutant} that the previous tests effectively kill all the mutants so no further changes are needed.

\subsubsection{isAfter}
\begin{figure}[H]
\begin{center}
\includegraphics[width=.99\textwidth]{images/MutationTesting/isAfterCode.png}
\end{center}
\caption{Code for the isAfter method}
\label{fig:isAfterCode}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=.99\textwidth]{images/MutationTesting/isAfterMutant.png}
\end{center}
\caption{Mutations for the isAfter method}
\label{fig:isAfterMutant}
\end{figure}
\setlength\intextsep{0pt}
The two Figures above show that the previous tests have mutants which survived.


\subsubsection{sendMsg}
\begin{figure}[H]
\begin{center}
\includegraphics[width=.99\textwidth]{images/MutationTesting/sendMsgCode.png}
\end{center}
\caption{Code for the sendMsg method}
\label{fig:sendMsgCode}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=.99\textwidth]{images/MutationTesting/sendMsgMutant.png}
\end{center}
\caption{Mutations for the sendMsg method}
\label{fig:sendMsgMutant}
\end{figure}
The results show that not all mutants have been killed. From Figure \ref{fig:sendMsgCode} we can see that our mutation testing results can be possibly improved if more tests on the server and socket state are created. 


\fontsize{14}{5}\textbf{After Additional Test Cases}

\begin{figure}[H]
\begin{center}
\includegraphics[width=.99\textwidth]{images/MutationTesting/sendMsgCodeAfter.png}
\end{center}
\caption{Updated code results for the sendMsg method}
\label{fig:sendMsgCodeAfter}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=.99\textwidth]{images/MutationTesting/sendMsgMutantAfter.png}
\end{center}
\caption{Updated mutations for the sendMsg method}
\label{fig:sendMsgMutantAfter}
\end{figure}

The testcase shown below was added and improved results to what is shown in Figures \ref{fig:sendMsgCodeAfter} and \ref{fig:sendMsgMutantAfter}. This testcase kills the mutant at lines 44, 48 without increasing line coverage. Thus, showing how testcases built for coverage alone are not sufficient. \\

The remaining bugs all relate to the \emph{close} function of the Socket object instantiated in the \emph{sendMsg} method. When Pitclipse mutates the \emph{close} function and removes it, this action causes a timeout. Which is why the \emph{sendMsg} method is defensively programmed to ensure that the socket connection is closed after the message is sent. Due to the amount of defensive programming and case of timeouts it is not possible to achieve full mutation testing coverage for this method consistently between all machines.

\begin{lstlisting}[caption={Additional test case for sendMsg},label={list:sendMsg}]
    @Test
    public void checkServerAlive() {
    String msg = null;
    SocketServer ss;
    String response;
        try {
            ss = new SocketServer(2922, this);
            response = SocketClient.sendMsg("localhost", 2922, msg);
            assertTrue(ss.isAlive());
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
\end{lstlisting}

\begin{itemize}
\item The data flow analysis you performed and the calculation of the coverage metrics. You must
show which test cases are responsible for which dc-paths.
\item A description of the test cases you added to improve coverage. If your coverage was already high,
discuss how your testing was able to achieve this.
\item The slices that you identified and the percentage of slices that your testing covers. You must
show which test cases are responsible for which slices.
\item A description of the test cases you added to improve slice coverage. If your coverage was
already high, discuss how your testing was able to achieve this.
\item Evaluate the effectiveness of your test cases using mutation testing. Discuss and address any
issues if you have found in your written report.
\item Attaching bug reports if bugs are discovered using your testing methods. You should use the
same bug report format as in Assignment 1. Do not file these bug reports to the projectâ€™s bug
report system.
\item An appendix with the specification of the methods you are testing
\end{itemize}

\section{JPetStore}

\begin{itemize}
\item The test scenarios that you have created;
\item The request rates and the duration of the load tests;
\item The analysis of your load tests and the description of any problems that you have found (if there
are any).
\end{itemize}

\end{document}
